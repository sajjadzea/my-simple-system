<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Diagram D3.js - Multi-layer View</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body { direction: rtl; background: #fafaff; font-family: Tahoma,sans-serif; }
        .summary-box {
            margin: 18px auto 16px auto;
            padding: 15px 20px 13px 12px;
            background: #f0f3fa;
            border-radius: 14px;
            border: 1px solid #d7e3f7;
            font-size: 16px;
            color: #20406a;
            max-width: 600px;
            box-shadow: 0 2px 12px #dde8ff30;
        }
        #main-container {
            display: flex;
            flex-wrap: wrap;
            gap: 26px;
            justify-content: center;
            align-items: flex-start;
            min-height: 80vh;
        }
        #diagram-container { flex: 3 1 570px; min-width: 350px; min-height: 420px; background: #fafaff; border-radius: 14px; }
        #diagram { width: 100%; height: 73vh; min-height: 430px; max-width: 99vw; }
        #info-panel {
            flex: 1 1 320px; min-width: 285px; background: #fffbe7; border-radius: 12px;
            border: 1.7px solid #d4c98c; padding: 22px 12px; box-shadow: 0 4px 16px #ccbe8c40; font-family: Tahoma;
            margin-top: 0;
        }
        #panel-content { font-size: 15px; }
        #panel-content a { color: #2196f3; text-decoration: underline; word-break: break-all; }
        #legend {
            margin: 12px 0 0 0; font-size: 14px; text-align: left; padding-right: 12px;
        }
        #layer-menu {
            margin: 18px 0 4px 0; text-align: center;
        }
        #layer-menu button {
            margin: 0 5px; padding: 7px 18px; border:none; border-radius:9px;
            background: #f4f4fd; color:#404099; font-weight: bold; font-size:14px; cursor:pointer;
            transition: background .18s;
        }
        #layer-menu button.active { background:#b388ff; color:#fff; }
        @media (max-width: 900px) {
            #main-container { flex-direction: column; align-items: stretch; gap: 20px; }
            #diagram-container, #info-panel { width: 97vw; min-width: 180px; margin: 0 auto; }
            .summary-box { font-size: 14px; padding: 9px 7px; max-width: 99vw; }
        }
    </style>
</head>
<body>
    <div class="summary-box">
        <b>خلاصه مدیریتی:</b>
        این نمودار سیستمی، زنجیره علّی و پیامدهای پروژه انتقال آب از کلات به مشهد را به تصویر می‌کشد.
        نمودار، نقش عوامل مختلف (از تغییرات اقلیمی و فشار تقاضا تا واکنش‌های اجتماعی و تصمیمات سیاسی) را در بروز چالش یا فرصت برای منابع آب منطقه روشن می‌کند و ابزاری برای تحلیل سیاست‌های بهینه، مدیریت تعارض منافع، و آینده‌نگری تصمیم‌سازان است.
    </div>
    <div id="layer-menu">
      <button data-layer="all" class="active">همه لایه‌ها</button>
      <button data-layer="political">سیاسی</button>
      <button data-layer="economic">اقتصادی</button>
      <button data-layer="environment">محیط‌زیست</button>
      <button data-layer="social">اجتماعی</button>
    </div>
    <div id="legend">
      <span style="display:inline-block;width:32px;height:6px;background:#1aaf5d;margin-left:5px;vertical-align:middle;"></span> یال مثبت (اثر افزاینده)
      &nbsp;&nbsp;
      <span style="display:inline-block;width:32px;height:6px;background:#e14646;border-bottom:3px dashed #e14646;margin-left:5px;vertical-align:middle;"></span> یال منفی (اثر کاهنده)
    </div>
    <div id="main-container">
      <div id="diagram-container"><svg id="diagram"></svg></div>
      <div id="info-panel"><div id="panel-content">برای مشاهده توضیحات و رفرنس، روی هر گره یا یال کلیک کنید.</div></div>
    </div>
    <script src="main.js"></script>
</body>
</html>
