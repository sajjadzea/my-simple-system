<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>داشبورد مدیریتی انتقال آب کلات</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="d3.v7.min.js"></script>
    <style>
        body { font-family: Vazirmatn,Tahoma,sans-serif; background:#f8f5f2; }
        .page-header { text-align:center; background:#7a6fff; color:#fff; padding:16px 0; font-size:24px; margin-bottom:20px; }
        /* styles for d3 graph from previous version */
        #main-container { display:flex; flex-wrap:wrap; gap:28px; justify-content:center; align-items:flex-start; min-height:82vh; }
        #diagram-container { flex:3 1 670px; min-width:390px; min-height:410px; background:#f3f8ffdd; border-radius:20px; box-shadow:0 6px 28px #8fc3ff2e; padding:12px 6px; border:1.7px solid #c7e3ff; position:relative; }
        #diagram { width:100%; height:72vh; min-height:430px; max-width:99vw; }
        #info-panel { flex:1 1 350px; min-width:255px; background:#fff7ebee; border-radius:16px; border:1.7px solid #ffd49b; padding:27px 20px 22px 15px; box-shadow:0 6px 26px #ffd59c30; margin-top:0; max-height:82vh; overflow-y:auto; transition:box-shadow .19s; }
        #panel-content { font-size:16.2px; }
        #layer-menu button { margin:0 8px; padding:9px 22px; border:none; border-radius:13px; background:#f3e8ff; color:#38387a; font-weight:bold; font-size:16px; cursor:pointer; transition:background .15s, box-shadow .17s; box-shadow:0 2px 9px #bcaaff14; }
        #layer-menu button.active { background:#7a6fff; color:#fff; box-shadow:0 2px 9px #a899ff50; }
    </style>
</head>
<body>
<header class="page-header">داشبورد مدیریتی</header>

<section id="dashboard" class="container mx-auto p-4">
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 text-center">
        <div class="bg-white p-6 rounded-lg shadow-lg">
            <h3 class="text-4xl font-bold text-purple-700">۲۰۸</h3>
            <p class="text-gray-500 mt-2">کیلومتر طول خط لوله</p>
        </div>
        <div class="bg-white p-6 rounded-lg shadow-lg">
            <h3 class="text-4xl font-bold text-purple-700">~۱۲</h3>
            <p class="text-gray-500 mt-2">هزار میلیارد تومان هزینه برآوردی</p>
        </div>
        <div class="bg-white p-6 rounded-lg shadow-lg">
            <h3 class="text-4xl font-bold text-purple-700">۴۰</h3>
            <p class="text-gray-500 mt-2">میلیون متر مکعب آب انتقالی در سال</p>
        </div>
        <div class="bg-white p-6 rounded-lg shadow-lg">
            <h3 class="text-4xl font-bold text-purple-700">۷۰٪</h3>
            <p class="text-gray-500 mt-2">پیشرفت فیزیکی (ادعای رسمی)</p>
        </div>
    </div>

    <div class="mt-12 bg-white p-6 rounded-lg shadow-lg max-w-xl mx-auto">
        <canvas id="waterChart" height="300"></canvas>
    </div>
</section>

<section id="system-graph" class="container mx-auto mt-16">
    <div class="summary-box">
        <b>خلاصه مدیریتی:</b>
        این داشبورد تعاملی، زنجیره علی و پیامدهای پروژه انتقال آب از کلات به مشهد را نمایش می‌دهد.
    </div>
    <div id="layer-menu" class="text-center my-4">
        <button data-layer="all" class="active">همه لایه‌ها</button>
        <button data-layer="political">سیاسی</button>
        <button data-layer="economic">اقتصادی</button>
        <button data-layer="environment">محیط‌زیست</button>
        <button data-layer="social">اجتماعی</button>
    </div>
    <div id="main-container">
        <div id="diagram-container"><svg id="diagram"></svg></div>
        <div id="info-panel"><div id="panel-content">برای مشاهده توضیحات و رفرنس، روی هر گره یا یال کلیک کنید.</div></div>
    </div>
</section>

<section id="stakeholders" class="container mx-auto mt-16">
    <div class="bg-white p-6 rounded-lg shadow-lg max-w-xl mx-auto">
        <canvas id="stakeholderChart" height="300"></canvas>
    </div>
</section>

<script>
const waterCtx = document.getElementById('waterChart').getContext('2d');
new Chart(waterCtx, {
    type: 'bar',
    data: {
        labels: ['آب قابل ادعا برای انتقال', 'آب مورد نیاز واقعی کلات'],
        datasets: [{
            label: 'میلیون متر مکعب در سال',
            data: [67, 80],
            backgroundColor: ['rgba(46,90,136,0.6)','rgba(169,92,66,0.6)'],
            borderColor: ['rgba(46,90,136,1)','rgba(169,92,66,1)'],
            borderWidth:1
        }]
    },
    options:{responsive:true, maintainAspectRatio:false, indexAxis:'y'}
});

const stakeholderCtx = document.getElementById('stakeholderChart').getContext('2d');
new Chart(stakeholderCtx, {
    type: 'polarArea',
    data: {
        labels: ['دولت','کارشناسان','محیط زیست','مردم محلی','قوه قضائیه'],
        datasets: [{
            data:[5,4,3,4,2],
            backgroundColor:[
                'rgba(46,90,136,0.7)',
                'rgba(249,178,8,0.7)',
                'rgba(28,150,96,0.7)',
                'rgba(169,92,66,0.7)',
                'rgba(128,128,128,0.7)'
            ]
        }]
    },
    options:{responsive:true, maintainAspectRatio:false}
});
</script>
<script src="main.js"></script>
</body>
</html>
